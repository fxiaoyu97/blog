(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{362:function(t,v,_){"use strict";_.r(v);var e=_(42),n=Object(e.a)({},(function(){var t=this,v=t.$createElement,_=t._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"nginx屏蔽指定ip"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#nginx屏蔽指定ip"}},[t._v("#")]),t._v(" nginx屏蔽指定IP")]),t._v(" "),_("p",[t._v("首先找到nginx的配置文件，只要在相关配置文件中添加一些配置语句即可。")]),t._v(" "),_("h2",{attrs:{id:"简单使用配置"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#简单使用配置"}},[t._v("#")]),t._v(" 简单使用配置")]),t._v(" "),_("ol",[_("li",[t._v("屏蔽单个IP地址，使用关键词deny，例如："),_("code",[t._v("deny 10.11.12.13")])]),t._v(" "),_("li",[t._v("允许单个IP地址，使用关键词allow，例如："),_("code",[t._v("allow 10.11.12.14")])]),t._v(" "),_("li",[t._v("屏蔽所有的IP地址："),_("code",[t._v("deny all")])]),t._v(" "),_("li",[t._v("允许所有IP地址："),_("code",[t._v("allow all")])]),t._v(" "),_("li",[t._v("屏蔽一定范围内IP地址，使用IP地址加子网掩码的组合。例如：\n"),_("ul",[_("li",[t._v("屏蔽10.0.0.1~10.255.255.254这个范围的ip地址："),_("code",[t._v("deny 10.0.0.0/8")])]),t._v(" "),_("li",[t._v("屏蔽10.11.0.1~10.11.255.254这个范围的IP地址："),_("code",[t._v("deny 10.11.0.0/16")])]),t._v(" "),_("li",[t._v("屏蔽10.11.12.1~10.11.12.254这个范围的IP地址："),_("code",[t._v("deny 10.11.12.0/24")])])])]),t._v(" "),_("li",[t._v("允许一定范围内的IP地址访问，同上所示，关键词换成"),_("code",[t._v("allow")]),t._v("。")])]),t._v(" "),_("p",[t._v("以上只是最基本的使用方法，那么问题来了，nginx做代理的时候，可以监听多个地址或者指向不同的网站，那么该怎么只针对不同的网站做区分呢？")]),t._v(" "),_("h2",{attrs:{id:"指定代理网站添加屏蔽策略"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#指定代理网站添加屏蔽策略"}},[t._v("#")]),t._v(" 指定代理网站添加屏蔽策略")]),t._v(" "),_("p",[t._v("针对上面的问题，我们只要把屏蔽IP的语句放在不同的位置就好了。在nginx的配置文件中，不同的语句块所产生的影响效果也是不一样的。")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("语句块")]),t._v(" "),_("th",[t._v("效果")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[_("code",[t._v("http{}")])]),t._v(" "),_("td",[t._v("对nginx的所有服务生效，所有代理网站都会受到影响")])]),t._v(" "),_("tr",[_("td",[_("code",[t._v("server{}")])]),t._v(" "),_("td",[t._v("指定的server服务，只对配置的代理网站起作用")])]),t._v(" "),_("tr",[_("td",[_("code",[t._v("location")])]),t._v(" "),_("td",[t._v("指定的访问地址")])]),t._v(" "),_("tr",[_("td",[_("code",[t._v("limit_except")])]),t._v(" "),_("td",[t._v("指定的http方法谓词")])])])]),t._v(" "),_("p",[t._v("如果现在有几百个不同的IP地址，它们又分布在不同的网段，这时候写在配置文件中，每个IP写一行，那这个配置文件岂不是要写的无比的长，可读性就太差了，修改起来也不方便。这时候我们该怎么办呢？")]),t._v(" "),_("h2",{attrs:{id:"写成单独的屏蔽策略配置文件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#写成单独的屏蔽策略配置文件"}},[t._v("#")]),t._v(" 写成单独的屏蔽策略配置文件")]),t._v(" "),_("p",[t._v("新建一个配置文件，例如"),_("code",[t._v("blockip.conf")]),t._v("，把所有的屏蔽ip策略可以写在这个文件中，最后我们只要在nginx的配置文件"),_("code",[t._v("nginx.conf")]),t._v("中引入即可，还可以在不同的语句块中引入，效果同上表所示。")]),t._v(" "),_("p",[t._v("屏蔽策略配置文件中可以写允许的IP地址，也可以写屏蔽的IP地址。但是有一点，"),_("strong",[t._v("当你只放开几个IP地址，然后屏蔽剩余所有IP地址时，一定要先写放行的ip地址。")])]),t._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[t._v("# 放行部分ip访问\nallow 10.11.12.13;\nallow 10.11.12.14;\nallow 10.11.12.15;\n # 禁止其余ip访问\ndeny all; \n")])]),t._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[t._v("1")]),_("br"),_("span",{staticClass:"line-number"},[t._v("2")]),_("br"),_("span",{staticClass:"line-number"},[t._v("3")]),_("br"),_("span",{staticClass:"line-number"},[t._v("4")]),_("br"),_("span",{staticClass:"line-number"},[t._v("5")]),_("br"),_("span",{staticClass:"line-number"},[t._v("6")]),_("br")])])])}),[],!1,null,null,null);v.default=n.exports}}]);